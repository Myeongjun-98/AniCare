<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>공지 목록</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="p-4">

<nav>
    <a href="/ad/reportList" class="nav-button">신고</a>
    <a href="/ad/enquiryReply" class="nav-button">문의</a>
    <a href="/ad/notice" class="nav-button">공지</a>
    <a href="/ad/hospital" class="nav-button">병원등록</a>
    <a href="/ad/masterAd" class="nav-button">계정관리</a>
    <a href="/logout" class="nav-button">로그아웃</a>
</nav>

<div class="d-flex justify-content-end mb-3">
    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#noticeWriteModal">글 작성</button>
</div>
<div class="modal fade" id="noticeWriteModal" tabindex="-1" aria-labelledby="noticeWriteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form th:action="@{/notice/new}" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="noticeWriteModalLabel">공지 작성</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">제목</label>
                        <input type="text" name="title" class="form-control" required />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">카테고리</label>
                        <select name="NoticeCategory" class="form-select" required>
                            <option value="공지">공지</option>
                            <option value="이벤트">이벤트</option>
                            <option value="알림">알림</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">내용</label>
                        <textarea name="body" class="form-control" rows="5" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">저장</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped">
        <thead class="table-primary">
        <tr>
            <th>번호</th>
            <th>카테고리</th>
            <th>제목</th>
            <th>요약</th>
            <th>작성일시</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="notice : ${notices}">

            <tr>
                <td th:text="${notice.id}">1</td>
                <td th:text="${notice.category}">공지</td>
                <td>
                    <a href="javascript:void(0);"
                       th:onclick="'toggleContent(' + ${notice.id} + ')'"
                       th:text="${notice.title}"
                       style="cursor:pointer; text-decoration:none;">
                    </a>
                </td>
                <td th:text="${notice.summary}">요약</td>
                <td th:text="${notice.date}">2025-04-30</td>
                <td>
                    <a th:href="@{/notice/{id}/edit(id=${notice.id})}" class="btn btn-sm btn-outline-primary">수정</a>
                    <form th:action="@{/notice/{id}/delete(id=${notice.id})}" method="post" style="display:inline">
                        <button type="submit" class="btn btn-sm btn-outline-danger"
                                onclick="return confirm('정말 삭제하시겠습니까?');">삭제</button>
                    </form>
                </td>
            </tr>

            <tr th:id="'content-' + ${notice.id}" style="display:none; background-color:#f9f9f9;">
                <td colspan="6">
                    <strong>내용:</strong>
                    <p th:text="${notice.content}">공지 내용입니다</p>
                </td>
            </tr>
        </th:block>
        </tbody>
    </table>
</div>

<script>
    function toggleContent(id) {
        const row = document.getElementById(`content-${id}`);
        row.style.display = row.style.display === "none" ? "table-row" : "none";
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
